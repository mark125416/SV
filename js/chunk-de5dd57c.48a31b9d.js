(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-de5dd57c"],{"521f":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.messages,expression:"messages"}],ref:"messageBox",staticClass:"lonelyMeg",attrs:{rows:"11",readonly:""},domProps:{value:t.messages},on:{input:function(e){e.target.composing||(t.messages=e.target.value)}}})},i=[],r=(n("82a8"),{props:{showMsg:{type:String,require:!1,default:""}},data:function(){return{messages:"",count:0}},methods:{showMessage:function(t){if(null!=t&&""!=t&&void 0!=t){this.count>=50?(this.messages=" "+t+"\r\n",this.count=1):this.messages+=" "+t+"\r\n";var e=this;setTimeout((function(){e.$refs.messageBox.scrollTop=e.$refs.messageBox.scrollHeight})),this.count++}}},mounted:function(){var t="User: "+JSON.parse(localStorage.getItem("profile")).name;this.showMessage(t)},updated:function(){}}),a=r,o=n("5d22"),u=Object(o["a"])(a,s,i,!1,null,null,null);e["a"]=u.exports},"5c5a":function(t,e,n){"use strict";n.d(e,"e",(function(){return s})),n.d(e,"g",(function(){return i})),n.d(e,"d",(function(){return r})),n.d(e,"f",(function(){return a})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return f}));n("4914"),n("95e8"),n("b34d"),n("a5bc"),n("b6b5"),n("0482"),n("31d6"),n("f845"),n("247c");function s(t){var e="",n=[];return n=t.split("/"),n.map((function(t,e){n[e]=t.trim()})),n.length>=6&&(-1!=n[5].indexOf("X")&&(n[5]=n[5].replace("X","")),e=n[5]),e}function i(t){var e=0,n=[];if(n=t.split("/"),n.map((function(t,e){n[e]=t.trim()})),n.length>=6){var s=n[2];-1!=s.indexOf("Q")&&(s=s.replace("Q","")),e=Number(s)}return e}function r(t){var e="",n=[];return n=t.split("*"),n.map((function(t,e){n[e]=t.trim()})),n.length>=6&&(-1!=n[1].indexOf("3OS")&&(n[1]=n[1].replace("3OS","")),e=n[1]),e}function a(t){for(var e="",n=t.split("*"),s=0;s<n.length;s++)n[s]=n[s].trim();return n.length>=6&&(e=n[0].replace(/\+/g,"").replace(/-/g,"")),e}var o=n("31d9");function u(t,e,n,s){return"X3S"==t||"X2S"==t?(o(s).endsWith("T")||(s=n%2==1?1:2,2==s&&(n-=1)),"L".concat(e,"-").concat(n,"-").concat(s)):"L".concat(e,"-").concat(n,"-").concat(s)}function c(t,e){var n=[],s=t.split("-"),i=0;return"AX501"==e?["E"+o(s[0].replace("L","")).padLeft(2,"0").s+o(s[1]).padLeft(2,"0").s]:e.startsWith("NPM")?["POS"+o(s[1]).padLeft(3,"0").s+"$"+s[2]]:(o(s[2]).endsWith("T")?n.push("POS001$"+s[2]):(i=parseInt(s[1]),"2"==s[2]&&(n.push("POS"+o(i+"").padLeft(3,"0").s+"$2"),i+=1),n.push("POS"+o(i+"").padLeft(3,"0").s+"$1")),n)}var f={ERR_LOGINFAILED:"200-登录失败",ERR_NOTNEEDVERIFY:"301-该料站不需要验料",ERR_NOTRACKINFO:"302-请扫描料站条码",ERR_NODIVISIONINFO:"303-请选择料槽号",ERR_NOCMPINFO:"304-请扫描物料",ERR_STATIONNOTINLINE:"305-机台不属于产线",ERR_SCANCOMPONENT:"306-请扫描物料",ERR_TEARDOWNFAILED:"307-卸下出错"}},"637c":function(t,e,n){"use strict";n("6ee9")},"6ee9":function(t,e,n){},"86bf":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Page",{attrs:{title:""}},[n("van-tabs",{attrs:{color:"#4284f4"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[n("van-tab",{attrs:{title:t.$t("离线检验")}},[n("MessageBox",{ref:"messageBox"}),n("van-field",{attrs:{label:t.$t("料车条码"),readonly:"readonly"},model:{value:t.carCode,callback:function(e){t.carCode=e},expression:"carCode"}}),n("ScanInput",{attrs:{label:t.$t("条码")},on:{submit:t.m_scanner_OnScannerReaded}}),n("van-button",{attrs:{type:"info",size:"large"},on:{click:function(e){return t.GotoNext()}}},[t._v(t._s(t.$t("跳过当前")))]),n("p"),n("van-button",{attrs:{type:"info",size:"large"},on:{click:function(e){return t.verify()}}},[t._v(t._s(t.$t("验证")))])],1),n("van-tab",{attrs:{title:t.$t("上料表")}},[n("div",[n("el-table",{attrs:{data:t.lstSetupList,"highlight-current-row":"",size:"mini"}},[n("el-table-column",{attrs:{prop:"PARTNUMBER",label:t.$t("元料料号"),"min-width":"35%"}}),n("el-table-column",{attrs:{prop:"location",label:t.$t("上料位置"),"min-width":"35%"}}),n("el-table-column",{attrs:{prop:"eRet",label:t.$t("检验结果"),"min-width":"35%"}})],1)],1)])],1)],1)},i=[],r=(n("a5bc"),n("31d6"),n("f845"),n("247c"),n("96f8"),n("d862"),n("96b3")),a=(n("6a61"),n("9ad1")),o=(n("5c26"),n("12f5")),u=(n("fe7f"),n("2b22")),c=(n("06bb"),n("28e4")),f=n("a593"),l=n("9973"),h=n("521f"),p=n("6168"),d=n("5c5a"),m=n("1c01"),S=n("f648"),g=n("6255"),_=n("4800"),L=n("31d9");f["default"].use(g["Table"]),f["default"].use(c["a"]),f["default"].use(u["a"]),f["default"].use(o["a"]);var I={components:{Page:l["a"],ScanInput:p["a"],MessageBox:h["a"]},data:function(){return{active:"1",float:"float",width_85:"width_85",isGray:"gray",class_width100:"width100",lstSetupList:[],m_scanner:"",m_tableCode:"",m_offlineTask:"",m_offlineSetupList:[],m_currentSetupItem:"",m_CurrentLine:"",m_offlineStationId:"",lblCurrPos:"",AppSession:"",txtCmp:{Text:""},m_currentIndex:-1,strTitle:"",btnVerify:{Enabled:!0},chkSortList:"",carCode:"",VerifyData:{}}},mounted:function(){this.m_offlineTask=JSON.parse(sessionStorage.getItem("offlineTask")),this.m_CurrentLine=JSON.parse(sessionStorage.getItem("offlineLine")),this.m_offlineStationId=JSON.parse(sessionStorage.getItem("offlineStationId")),this.LoadSetupData()},methods:{showMessage:function(t){this.$refs.messageBox.showMessage(t)},LoadSetupData:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,s,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m["c"]({PM_PreProductionId:t.m_offlineTask.Id,StationId:sessionStorage.getItem("offlineStationId")});case 3:if(n=e.sent,!(null==n||n.Items.Length<0)){e.next=7;break}return Object(r["a"])(t.$t("无上料表")),e.abrupt("return");case 7:for(s=sessionStorage.getItem("offlineLocationIndex"),t.m_offlineSetupList=[],i=0;i<n.Items.length;i++)a=n.Items[i],-1!=a.Location.indexOf("_")&&(a.Location=a.Location.split("_")[1]),L(a.Location).startsWith("LOC".concat(s))&&t.m_offlineSetupList.push(a);e.next=16;break;case 12:return e.prev=12,e.t0=e["catch"](0),Object(r["a"])(e.t0),e.abrupt("return");case 16:t.ShowOfflineSetupListIntoListView(),null!=t.m_offlineSetupList&&t.m_offlineSetupList.length>0&&t.GotoNext();case 18:case"end":return e.stop()}}),e,null,[[0,12]])})))()},m_scanner_OnScannerReaded:function(t){try{if(null==this.m_offlineSetupList&&0==this.m_offlineSetupList.length)return;if("TAB"==t.substring(0,3))this.carCode=t;else{if(!this.carCode)return void this.showMessage(this.$t("请先扫描料车"));if(this.showMessage(this.$t("扫描到物料：")+t),-1!=t.indexOf("*")&&(t=null!=this.AppSession.CurrentLine&&30==this.AppSession.CurrentLine.BARCODE_RULE?Object(d["f"])(t):Object(d["e"])(t),null==t||t.trim().length>0))return void this.showMessage(this.$t("条码格式不正确"));this.txtCmp.Text=t,this.VerifyData.ComponentBarcode=t,this.Verify()}}catch(e){this.showMessage("m_scanner_OnScannerReaded():"+e)}},ShowOfflineSetupListIntoListView:function(){var t=this;try{this.lstSetupList.length=0,this.m_offlineSetupList.forEach((function(e){var n="";switch(e.VerifyStatus){case S["c"].Pending:n=t.$t("待验证");break;case S["c"].Pass:n=t.$t("验证通过");break;case S["c"].Failed:n=t.$t("验证失败");break}var s={location:e.Location,PARTNUMBER:e.PartNumber,eRet:n,Id:e.Id};e.VerifyStatus==S["c"].Failed?s.backColor="#FFC7C7":e.VerifyStatus==S["c"].Pass?s.backColor="#7DE752":s.backColor="#D6F6F9",s.Tag=e,t.lstSetupList.push(s)}))}catch(e){this.showMessage("ShowOfflineSetupListIntoListView():"+e)}},ShowCurrentSetup:function(){try{if(this.m_currentIndex<0||null==this.m_offlineSetupList||this.m_currentIndex>this.m_offlineSetupList.length-1)return;this.txtCmp.Text="",this.m_currentSetupItem=this.m_offlineSetupList[this.m_currentIndex],this.showMessage(this.$t("当前检验料站：")+this.m_currentSetupItem.Location),this.showMessage(this.$t("需要物料：")+this.m_currentSetupItem.PartNumber)}catch(t){this.showMessage("ShowCurrentSetup():"+t)}},GotoNext:function(){try{if(++this.m_currentIndex,this.m_currentIndex>=this.m_offlineSetupList.length){this.m_currentIndex=0;var t=_.from(this.m_offlineSetupList).count((function(t){return t.VerifyStatus!=S["c"].Pass}));if(0==t)return this.btnVerify.Enabled=!1,this.showMessage(this.$t("已完成验料！")),void(this.m_currentSetupItem=null)}this.m_offlineSetupList[this.m_currentIndex].VerifyStatus==S["c"].Pass?this.GotoNext():this.ShowCurrentSetup()}catch(e){this.showMessage("GotoNext():"+e)}},Verify:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=t.m_currentSetupItem){e.next=2;break}return e.abrupt("return");case 2:if(t.txtCmp.Text){e.next=4;break}return e.abrupt("return");case 4:return t.showMessage(t.$t("开始验证...")),t.VerifyData.OnlineSetupList=t.m_currentSetupItem,t.btnVerify.Enabled=!1,e.prev=7,t.VerifyData.ComponentBarcode=t.txtCmp.Text.trim(),e.next=11,m["r"](t.m_offlineTask.Id,t.m_offlineStationId,t.carCode+"_"+t.VerifyData.OnlineSetupList.Location,t.VerifyData.ComponentBarcode);case 11:n=e.sent,t.txtCmp.Text="",n&&n.VerifyStatus==S["c"].Pass?(t.m_currentSetupItem.VerifyStatus=S["c"].Pass,s=_.from(t.m_offlineSetupList).count((function(t){return t.VerifyStatus!=S["c"].Pass})),t.showMessage(t.$t("验证成功...")),t.showMessage(t.$t("待验料数量:{0}",[s])),t.m_currentSetupItem=null,t.GotoNext()):(t.m_currentSetupItem.VERIFICATION_RESULT=S["c"].Failed,t.showMessage(t.$t("验证失败..."))),t.ShowOfflineSetupListIntoListView(),e.next=22;break;case 17:e.prev=17,e.t0=e["catch"](7),t.showMessage("Verify():"+e.t0),t.showMessage(e.t0),t.showMessage(t.$t("请求超时,请重新操作"));case 22:return e.prev=22,t.btnVerify.Enabled=!0,e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[7,17,22,25]])})))()},chkSortList_CheckStateChanged:function(){try{this.chkSortList.Checked?this.m_offlineSetupList=_.from(this.m_offlineSetupList).OrderBy((function(t){return t.DIVISION})).ThenBy((function(t){return t.TRACK})).ToList():this.m_offlineSetupList=_.from(this.m_offlineSetupList).OrderBy((function(t){return t.TRACK})).ThenBy((function(t){return t.DIVISION})).ToList(),this.ShowOfflineSetupListIntoListView(),null!=this.m_offlineSetupList&&this.m_offlineSetupList.Count>0&&(this.m_currentIndex=-1,this.GotoNext())}catch(t){this.showMessage("Verify():"+t)}}}},b=I,v=(n("637c"),n("5d22")),w=Object(v["a"])(b,s,i,!1,null,null,null);e["default"]=w.exports},"95e8":function(t,e,n){"use strict";var s=n("4292"),i=n("0a86").map,r=n("b9d5"),a=r("map");s({target:"Array",proto:!0,forced:!a},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},f648:function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}));var s={Pending:10,Pass:20,Failed:30,Reverify_Pass:4,Reverify_Failed:5},i={Locked:1,Closed:2,Completed:3,Initialized:4,MRPLocked:5,Prepared:6,QALocked:7,Ready:8,InProcess:9},r={WatingUse:1,Using:2,Bad:3}},f845:function(t,e,n){"use strict";var s=n("4292"),i=n("016e").f,r=n("2730"),a=n("6ff7"),o=n("11a1"),u=n("8531"),c=n("0fee"),f="".startsWith,l=Math.min,h=u("startsWith"),p=!c&&!h&&!!function(){var t=i(String.prototype,"startsWith");return t&&!t.writable}();s({target:"String",proto:!0,forced:!p&&!h},{startsWith:function(t){var e=String(o(this));a(t);var n=r(l(arguments.length>1?arguments[1]:void 0,e.length)),s=String(t);return f?f.call(e,s,n):e.slice(n,n+s.length)===s}})}}]);