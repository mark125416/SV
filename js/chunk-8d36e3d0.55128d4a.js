(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8d36e3d0"],{3073:function(e,t,n){},"521f":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.messages,expression:"messages"}],ref:"messageBox",staticClass:"lonelyMeg",attrs:{rows:"11",readonly:""},domProps:{value:e.messages},on:{input:function(t){t.target.composing||(e.messages=t.target.value)}}})},r=[],i=(n("82a8"),{props:{showMsg:{type:String,require:!1,default:""}},data:function(){return{messages:"",count:0}},methods:{showMessage:function(e){if(null!=e&&""!=e&&void 0!=e){this.count>=50?(this.messages=" "+e+"\r\n",this.count=1):this.messages+=" "+e+"\r\n";var t=this;setTimeout((function(){t.$refs.messageBox.scrollTop=t.$refs.messageBox.scrollHeight})),this.count++}}},mounted:function(){var e="User: "+JSON.parse(localStorage.getItem("profile")).name;this.showMessage(e)},updated:function(){}}),o=i,s=n("5d22"),c=Object(s["a"])(o,a,r,!1,null,null,null);t["a"]=c.exports},"54ca":function(e,t,n){"use strict";n("3073")},"5d2d":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Page",{attrs:{title:e.$t("产品下线"),msgs:"false"}},[n("van-tabs",{attrs:{color:"#4284f4"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[n("van-tab",{attrs:{title:e.$t("操作")}},[n("ScanInput",{directives:[{name:"show",rawName:"v-show",value:e.isShowScan,expression:"isShowScan"}],attrs:{label:e.$t("条码")},on:{submit:e.m_scanner_OnScannerReaded}}),n("MessageBox",{ref:"messageBox",staticClass:"lonelyMeg"}),n("div",{staticClass:"dropdown"},[n("span",[e._v(e._s(e.$t("产线")))]),n("van-dropdown-menu",{staticClass:"drop"},[n("van-dropdown-item",{attrs:{options:e.optionLine},model:{value:e.lineId,callback:function(t){e.lineId=t},expression:"lineId"}})],1)],1),n("div",{staticClass:"batchBox"},[n("span",[e._v(e._s(e.$t("批次")))]),n("van-field",{staticStyle:{padding:"0 !important"},attrs:{readonly:"",clearable:""},scopedSlots:e._u([{key:"button",fn:function(){return[n("van-icon",{attrs:{name:"points",size:"20",color:"#4284f4"},on:{click:e.showPlanList}})]},proxy:!0}]),model:{value:e.Bacth,callback:function(t){e.Bacth=t},expression:"Bacth"}})],1),n("InputCell",{attrs:{title:e.$t("容器"),value:e.carCode},on:{"update:value":function(t){e.carCode=t}}}),n("InputEditCell",{attrs:{title:e.$t("数量"),value:e.qty,type:"number"},on:{"update:value":function(t){e.qty=t}}}),n("div",{staticClass:"offlineTableBox"},[e._v(" "+e._s(e.$t("类型"))+" "),n("van-radio-group",{attrs:{"icon-size":"14px",direction:"horizontal"},model:{value:e.productionType,callback:function(t){e.productionType=t},expression:"productionType"}},[n("van-radio",{attrs:{name:"1"}},[e._v(e._s(e.$t("量产")))]),n("van-radio",{attrs:{name:"2"}},[e._v(e._s(e.$t("试产")))])],1)],1),n("van-button",{staticClass:"BtnButton",attrs:{type:"info"},on:{click:e.btnOffLine_Click}},[e._v(e._s(e.$t("确认")))])],1),n("van-tab",{attrs:{title:e.$t("记录")}},[n("el-table",{attrs:{data:e.List,"highlight-current-row":"",size:"mini",height:e.tableH}},[n("el-table-column",{attrs:{prop:"LineName",label:e.$t("产线"),"min-width":"20%"}}),n("el-table-column",{attrs:{prop:"Lot",label:e.$t("批次"),"min-width":"20%"}}),n("el-table-column",{attrs:{prop:"Capacity",label:e.$t("容量"),"min-width":"20%"}}),n("el-table-column",{attrs:{prop:"Qty",label:e.$t("下线数量"),"min-width":"30%"}})],1)],1)],1),n("van-overlay",{attrs:{show:e.batchShow},on:{click:function(t){e.batchShow=!1}}},[n("div",{staticClass:"wrapper",on:{click:function(e){e.stopPropagation()}}},[n("div",{staticClass:"addressBox",attrs:{id:"addressBox"}},[n("div",{staticClass:"topDiv"},[e._v(e._s(e.$t("选择批次")))]),n("div",{staticClass:"dropdownBatch"},[n("van-field",{attrs:{placeholder:e.$t("输入批次")},model:{value:e.batch,callback:function(t){e.batch=t},expression:"batch"}}),n("select",{attrs:{id:"BatchSelect"}},e._l(e.optionBatch,(function(t,a){return n("option",{key:a,domProps:{value:a}},[e._v(e._s(t.text))])})),0),n("van-field",{attrs:{center:"",clearable:"",placeholder:e.$t("日期"),readonly:""},on:{focus:function(t){e.dataPickerS=!0}},scopedSlots:e._u([{key:"button",fn:function(){return[n("van-icon",{attrs:{name:"search",size:"20",color:"#4284f4"},on:{click:e.showPlanList}})]},proxy:!0}]),model:{value:e.SelectDate,callback:function(t){e.SelectDate=t},expression:"SelectDate"}})],1),n("van-tabs",[n("van-tab",[n("el-table",{attrs:{data:e.lstWorkOrder,"highlight-current-row":"",size:"mini",height:e.tableH2},on:{"row-click":e.clickWorkOrder}},[n("el-table-column",{attrs:{prop:"Lot",label:e.$t("批次"),"min-width":"33%"}}),n("el-table-column",{attrs:{prop:"BoardSideName",label:e.$t("板面"),"min-width":"33%"}}),n("el-table-column",{attrs:{prop:"PlanedStartTime",label:e.$t("计划日期"),"min-width":"33%"}})],1)],1)],1),n("van-button",{attrs:{type:"info"},on:{click:e.makesureBatch}},[e._v(e._s(e.$t("确定")))])],1)])]),n("van-overlay",{attrs:{show:e.dataPickerS},on:{click:function(t){e.dataPickerS=!1}}},[n("div",{staticClass:"wrapperD",on:{click:function(e){e.stopPropagation()}}},[n("van-datetime-picker",{attrs:{type:"date",title:e.$t("选择年月日"),"min-date":e.minDate,"max-date":e.maxDate},on:{confirm:e.SelectDateConfirm,cancel:function(t){e.dataPickerS=!1}},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1)])],1)},r=[],i=(n("4914"),n("247c"),n("6a61"),n("9ad1")),o=(n("d862"),n("96b3")),s=(n("8f83"),n("608b")),c=(n("53a6"),n("ae24")),l=(n("3220"),n("8e51")),u=(n("8019"),n("a97c")),d=(n("42e2"),n("7b07")),p=(n("06bb"),n("28e4")),f=n("a593"),h=n("9973"),m=n("b7bd"),v=n("6168"),b=n("521f"),w=n("bda9"),g=n("1c01"),x=n("c9c2"),y=n("b775"),k=n("3753");function C(e){return S.apply(this,arguments)}function S(){return S=Object(i["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(y["a"])(Object(k["a"])("PL/WorkOrderAPI/GetAll",{}),{method:"POST",body:t});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}var _=n("4800");f["default"].use(p["a"]),f["default"].use(d["a"]),f["default"].use(u["a"]),f["default"].use(l["a"]),f["default"].use(c["a"]),f["default"].use(s["a"]),f["default"].use(o["a"]);var B={components:{Page:h["a"],MessageBox:b["a"],ScanInput:v["a"],InputEditCell:w["a"],InputCell:m["a"]},data:function(){return{isShowScan:!1,type:1,float_L:"float_L",width_25vw:"width_25vw",width_20vw:"width_20vw",clear:"clear",Btn:"Btn",lineBox:"lineBox",numDiv:"numDiv",radioClass:"radioClass",lstWorkOrder:[],selectedWorkorder:null,carCode:"",qty:0,Capacity:0,submitting:!1,value:0,optionLine:[],optionBatch:[{text:"T",value:"1"},{text:"B",value:"2"}],batchShow:!1,active:0,List:[],lineId:0,productionType:"1",Bacth:"",SelectDate:null,minDate:new Date(2020,0,1),maxDate:new Date(2025,10,1),currentDate:new Date,dataPickerS:!1,batch:"",workOrder:null,tableH:"0",tableH2:"0"}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableH=window.screen.height-30-46,e.tableH2="360px",n=(new Date).getTime()-864e5,a=new Date(n),e.SelectDateConfirm(a),e.currentDate=a,t.next=8,x["b"]({Line_Type:3});case 8:r=t.sent,r&&r.Items&&r.Items.length>0&&(r=_.from(r.Items).select((function(e){return{text:e.LineName,value:e.Id}})).toArray()),e.optionLine=r;case 11:case"end":return t.stop()}}),t)})))()},methods:{showMessage:function(e){this.$refs.messageBox.showMessage(e)},clickWorkOrder:function(e){this.workOrder=e},showPlanList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.lineId&&0!=e.lineId){t.next=3;break}return Object(o["a"])(e.$t("请选择产线")),t.abrupt("return");case 3:return e.lstWorkOrder=[],n=document.getElementById("BatchSelect"),a=n.selectedIndex,r=e.optionBatch[a].value,e.batchShow=!0,t.next=10,C({LineId:e.lineId,Lot:e.batch,BoardSide:r,StartTime:e.currentDate});case 10:i=t.sent,i&&i.Items.length>0&&(e.lstWorkOrder=i.Items);case 12:case"end":return t.stop()}}),t)})))()},SelectDateConfirm:function(e){var t=e.getFullYear(),n=e.getMonth()+1,a=e.getDate();this.SelectDate="".concat(t,"-").concat(n,"-").concat(a),this.currentDate=e,this.dataPickerS=!1},makesureBatch:function(){this.selectedWorkorder=this.workOrder.Id,this.Bacth=this.workOrder.Lot,this.batchShow=!1},m_scanner_OnScannerReaded:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,e=e.trim(),n.next=4,t.CheckBoxCode(e);case 4:if(a=n.sent,a){n.next=10;break}return n.next=8,t.CheckBarcode(e);case 8:r=n.sent,r||t.showMessage(t.$t("条码错误"));case 10:n.next=15;break;case 12:n.prev=12,n.t0=n["catch"](0),t.showMessage(n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,12]])})))()},OffLine:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.lineId&&0!=e.lineId){t.next=3;break}return Object(o["a"])(e.$t("请选择产线")),t.abrupt("return");case 3:if(e.Bacth){t.next=6;break}return Object(o["a"])(e.$t("请选择批次!")),t.abrupt("return");case 6:if(0!=e.Capacity){t.next=9;break}return Object(o["a"])(e.$t("请扫描容器!")),t.abrupt("return");case 9:if(!(e.qty>e.Capacity)){t.next=12;break}return Object(o["a"])(e.$t("数量不能大于容器容量!")),t.abrupt("return");case 12:return t.prev=12,e.submitting=!0,t.next=16,g["t"](e.selectedWorkorder,e.carCode,e.qty,e.productionType);case 16:n=t.sent,e.submitting=!1,n&&(n.Result?(e.showMessage(e.$t("产品下线成功")),a="",r=_.from(e.optionLine).where((function(t){return t.value==e.lineId})).toArray()[0].text,a+="\r\n Line:"+r,a+="\r\n Bacth:"+e.Bacth,a+="\r\n Container:"+e.carCode,a+="\r\n Qty:"+e.qty,"1"==e.productionType?a+="\r\n Type:"+e.$t("量产"):a+="\r\n Type:"+e.$t("试产"),a+=" \r\n "+e.$t("Result:Operation success!"),e.showMessage(a),e.List.push({LineName:r,Lot:e.Bacth,Capacity:e.Capacity,Qty:e.qty}),e.carCode="",e.Capacity=0,e.batch="",e.qty=0):e.showMessage(n.Message)),t.next=25;break;case 21:return t.prev=21,t.t0=t["catch"](12),e.showMessage(t.t0),t.abrupt("return");case 25:case"end":return t.stop()}}),t,null,[[12,21]])})))()},CheckBoxCode:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,x["a"]({EBoxCode:e});case 2:if(a=n.sent,a&&0!=a.Items.length){n.next=5;break}return n.abrupt("return",!1);case 5:return r=a.Items[0],t.carCode=e,t.showMessage(t.$t("扫描到容器条码:")+t.carCode),t.Capacity=r.Capacity,t.qty=r.Capacity,n.abrupt("return",!0);case 11:case"end":return n.stop()}}),n)})))()},CheckBarcode:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,g["g"](e);case 2:if(a=n.sent,!a){n.next=8;break}return t.selectedWorkorder=a.Id,t.Bacth=a.Lot,t.lineId=a.FAC_LineId,n.abrupt("return",!0);case 8:return n.abrupt("return",!1);case 9:case"end":return n.stop()}}),n)})))()},btnOffLine_Click:function(){this.OffLine()},txtBoxCode_KeyDown:function(e){13==e.KeyCode&&""!=this.txtBoxCode.Text.trim()&&this.SetBoxCode()}}},$=B,O=(n("6c090"),n("5d22")),I=Object(O["a"])($,a,r,!1,null,null,null);t["default"]=I.exports},"6c090":function(e,t,n){"use strict";n("ddf8")},b4a7:function(e,t,n){"use strict";n("c276")},b7bd:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("van-cell",{staticClass:"cellAll",scopedSlots:e._u([{key:"title",fn:function(){return[n("div",{staticClass:"custom-title"},[e._v(e._s(e.title))]),n("van-field",{staticClass:"filed",attrs:{autosize:"",type:e.type,clearable:""},on:{input:e.onInput,focus:e.fieldFocus,blur:e.fieldBlur},scopedSlots:e._u([{key:"right-icon",fn:function(){return[n("van-icon",{attrs:{name:"scan",size:"20",color:"#4284f4"}})]},proxy:!0}]),model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})]},proxy:!0}])})},r=[],i={props:{title:{type:String,require:!1,default:"标题"},value:{require:!1,default:""},type:{type:String,require:!1,default:"textarea"}},methods:{onInput:function(e){this.value=e,this.$emit("update:value",e)},GetVal:function(){return this.value},fieldBlur:function(){window.scroll(0,this.FoucusS),window.onresize=function(){}},fieldFocus:function(){this.FoucusS=document.documentElement.scrollTop-40,window.onresize=function(){return function(){var e=document.body.clientHeight;window.scroll(0,e)}()}}}},o=i,s=(n("54ca"),n("5d22")),c=Object(s["a"])(o,a,r,!1,null,null,null);t["a"]=c.exports},bda9:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("van-cell",{staticClass:"cellAll",scopedSlots:e._u([{key:"title",fn:function(){return[n("div",{staticClass:"custom-title"},[e._v(e._s(e.title))]),n("van-field",{staticClass:"filed",attrs:{clearable:"",type:e.type},on:{input:e.onInput,focus:e.fieldFocus,blur:e.fieldBlur},scopedSlots:e._u([{key:"right-icon",fn:function(){return[n("van-icon",{attrs:{name:"edit",size:"20",color:"#4284f4"}})]},proxy:!0}]),model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})]},proxy:!0}])})},r=[],i={props:{title:{type:String,require:!1,default:"标题"},value:{require:!1,default:""},type:{type:String,require:!1,default:"text"}},methods:{onInput:function(e){this.value=e,this.$emit("update:value",e)},GetVal:function(){return this.value},fieldBlur:function(){window.scroll(0,this.FoucusS),window.onresize=function(){}},fieldFocus:function(){this.FoucusS=document.documentElement.scrollTop-40,window.onresize=function(){return function(){var e=document.body.clientHeight;window.scroll(0,e)}()}}}},o=i,s=(n("b4a7"),n("5d22")),c=Object(s["a"])(o,a,r,!1,null,null,null);t["a"]=c.exports},c276:function(e,t,n){},ddf8:function(e,t,n){}}]);