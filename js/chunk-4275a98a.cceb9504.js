(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4275a98a"],{3073:function(t,e,n){},"521f":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.messages,expression:"messages"}],ref:"messageBox",staticClass:"lonelyMeg",attrs:{rows:"11",readonly:""},domProps:{value:t.messages},on:{input:function(e){e.target.composing||(t.messages=e.target.value)}}})},s=[],i=(n("82a8"),{props:{showMsg:{type:String,require:!1,default:""}},data:function(){return{messages:"",count:0}},methods:{showMessage:function(t){if(null!=t&&""!=t&&void 0!=t){this.count>=50?(this.messages=" "+t+"\r\n",this.count=1):this.messages+=" "+t+"\r\n";var e=this;setTimeout((function(){e.$refs.messageBox.scrollTop=e.$refs.messageBox.scrollHeight})),this.count++}}},mounted:function(){var t="User: "+JSON.parse(localStorage.getItem("profile")).name;this.showMessage(t)},updated:function(){}}),a=i,o=n("5d22"),u=Object(o["a"])(a,r,s,!1,null,null,null);e["a"]=u.exports},"54ca":function(t,e,n){"use strict";n("3073")},"59a7":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Page",{attrs:{title:t.$t("接料检验")}},[t.div2==t.nowDiv?n("div",{staticClass:"dic1"},[n("div",{staticClass:"topDiv"},[t._v(" "+t._s(t.$t("程序名"))+"："+t._s(t.program)+" "),n("br"),t._v(" "+t._s(t.$t("区域"))+":"+t._s(t.area)+" ")]),n("MessageBox",{ref:"messageBox",staticClass:"lonelyMeg"}),n("ScanInput",{directives:[{name:"show",rawName:"v-show",value:t.isShowScan,expression:"isShowScan"}],attrs:{label:t.$t("扫描条码")},on:{submit:t.m_scanner_OnScannerReaded}}),n("InputCell",{attrs:{title:t.$t("物料条码"),value:t.txtCmp.Text},on:{"update:value":function(e){return t.$set(t.txtCmp,"Text",e)}}}),n("InputCell",{attrs:{title:t.$t("站位号"),value:t.displayLocation},on:{"update:value":function(e){t.displayLocation=e}}}),"AX501"==t.equipmentName?n("van-button",{staticStyle:{width:"calc(100vw - 30px)",margin:"10px 0 0 15px"},attrs:{type:"info"},on:{click:t.isTopFirstC}},[t._v(t._s(t.$t("上排优先")))]):t._e(),n("van-button",{staticClass:"BtnButton",attrs:{type:"info",loading:!t.btnVerify_Enabled},on:{click:t.Verify}},[t._v(t._s(t.$t("检验")))])],1):t._e()])},s=[],i=(n("a5bc"),n("31d6"),n("247c"),n("6a61"),n("9ad1")),a=(n("06bb"),n("28e4")),o=n("a593"),u=n("6168"),c=n("b7bd"),l=n("521f"),p=n("9973"),f=n("1c01"),m=n("5c5a"),h=n("f648"),d=n("cf45");o["default"].use(a["a"]);var g=n("4800"),x={components:{Page:p["a"],MessageBox:l["a"],ScanInput:u["a"],InputCell:c["a"]},data:function(){return{class_width_80:"width80",clear:"clear",float:"float",class_width_70:"width70",btnUpper:{Text:this.$t("上"),Visible:!0,Tag:1},m_onlineSetupList:"",m_strSetupName:"",m_currentSetupItem:"",m_scanner:"",txtTrack:{Text:""},CurrentLine:"",txtCmp:{Text:""},btnVerify_Enabled:!0,VerifyData:{},nowDiv:1,div1:0,div2:1,showMsg:"",area:"",program:"",activeTab:0,code:"",num:"",isShowScan:!1,equipmentName:"",displayLocation:""}},mounted:function(){try{var t=JSON.parse(window.localStorage.getItem("currentLine")),e=JSON.parse(window.localStorage.getItem("currentUser"));this.$nextTick((function(){this.CurrentLocationIndex=this.$store.getters["svSession/getCurrentLocationIndex"],this.currentStation=this.$store.getters["svSession/getCurrentStation"],this.equipmentName=this.currentStation.STATION_NAME,this.area=t.LINE_NAME+", "+this.equipmentName+" , L"+this.CurrentLocationIndex,this.VerifyData.VerificationMode="RefillVerify",this.VerifyData.LineName=t.LINE_NAME,this.VerifyData.StationName=this.equipmentName,this.VerifyData.Operator=e.STAFF_NUMBER,window._currentMessageBox=this.$refs.messageBox,this.LoadSetupData()}))}catch(n){this.showMessage("EventsCenter_OnFormReady():"+n)}},methods:{showMessage:function(t){this.$refs.messageBox.showMessage(t)},nextBtn:function(){this.nowDiv=1},LoadSetupData:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.setupLists=[],e.next=4,f["p"]({stationId:t.$store.getters["svSession/getCurrentStation"].Id,locationIndex:t.$store.getters["svSession/getCurrentLocationIndex"],isTopFirst:!1});case 4:if(n=e.sent,n||!(null==n.lstOnlineSetupList||n.lstOnlineSetupList.length<=0)){e.next=8;break}return t.showMessage(t.$t("无上料表")),e.abrupt("return");case 8:r=n.lstOnlineSetupList,t.program=n.recipeName,t.VerifyData.RecipeName=n.recipeName,t.m_onlineSetupList=r,e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](0),t.showMessage(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))()},m_scanner_OnScannerReaded:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,s,i,a,o,u,c,l,p,f,h;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.prev=0,null!=e.m_onlineSetupList||0!=e.m_onlineSetupList.length){n.next=3;break}return n.abrupt("return");case 3:if(r=/POS(.*)\$(\d)/i,s=r.test(t),i=/^E\d{4}/,a=i.test(t),!s){n.next=22;break}if(e.btnUpper.Visible&&(e.btnUpper.Visible=!1),e.m_currentSetupItem=g.from(e.m_onlineSetupList).firstOrDefault((function(e){return-1!=e.POSITION_CODE.indexOf(t)})),null!=e.m_currentSetupItem){n.next=12;break}return n.abrupt("return");case 12:console.log(e.m_currentSetupItem),o=e.m_currentSetupItem.Location,u=e.m_currentSetupItem.DisplayLocation,e.showMessage(e.$t("扫描到上料位：{0}",[u])),e.txtTrack.Text=o,console.log(e.txtTrack.Text),e.displayLocation=u,e.VerifyData.OnlineSetupList=e.m_currentSetupItem,n.next=54;break;case 22:if(!a){n.next=42;break}if(e.btnUpper.Visible||(e.btnUpper.Visible=!0),c=e.btnUpper.tag,e.m_currentSetupItem=g.from(e.m_onlineSetupList).firstOrDefault((function(e){return-1!=e.PosTexts.indexOf(t)})),null!=e.m_currentSetupItem){n.next=34;break}if(l=1==c?2:1,e.m_currentSetupItem=g.from(e.m_onlineSetupList).firstOrDefault((function(e){return-1!=e.PosTexts.indexOf(t)})),null!=e.m_currentSetupItem){n.next=31;break}return n.abrupt("return");case 31:p=e.m_currentSetupItem.Location,e.showMessage(1==l?e.$t("发现上侧有物料，自动切换到{0}",[p]):e.$t("发现下侧有物料，自动切换到{0}",[p])),e.btnUpper_Click();case 34:f=e.m_currentSetupItem.Location,h=e.m_currentSetupItem.DisplayLocation,e.showMessage(e.$t("扫描到上料位：{0}",[h])),e.txtTrack.Text=f,e.displayLocation=h,e.VerifyData.OnlineSetupList=e.m_currentSetupItem,n.next=54;break;case 42:if(e.VerifyData.PartBarcode=t,-1==t.indexOf("/")){n.next=50;break}if(t=Object(m["e"])(t),!(null==t||t.trim().length<=0)){n.next=48;break}return e.showMessage(e.$t("条码格式不正确")),n.abrupt("return");case 48:n.next=52;break;case 50:return e.showMessage(e.$t("条码格式不正确")),n.abrupt("return");case 52:e.showMessage(e.$t("扫描到物料：{0}",[t])),e.txtCmp.Text=t;case 54:!e.txtTrack.Text||e.txtTrack.Text.trim().length<=0||!e.txtCmp.Text||e.txtCmp.Text.trim().length<=0||e.Verify(),n.next=60;break;case 57:n.prev=57,n.t0=n["catch"](0),e.showMessage("m_scanner_OnScannerReaded():".concat(n.t0));case 60:case"end":return n.stop()}}),n,null,[[0,57]])})))()},Verify:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.showMessage(t.$t("开始验证...")),t.btnVerify_Enabled=!1,e.prev=2,t.VerifyData.ComponentBarcode=t.txtCmp.Text.trim(),e.next=6,f["s"](t.VerifyData);case 6:n=e.sent,t.txtCmp_Text="",n&&n.VERIFICATION_RESULT==h["c"].Pass?(Object(d["d"])(),t.showMessage(t.$t("验证成功...")),t.txtTrack.Text="",t.displayLocation="",t.txtCmp.Text=""):(Object(d["c"])(),t.showMessage(t.$t("验料失败"))),n&&(t.m_currentSetupItem.VERIFICATION_RESULT=n.VERIFICATION_RESULT),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](2),console.log(e.t0),t.showMessage(t.$t("请求超时,请重新操作"));case 16:return e.prev=16,t.btnVerify_Enabled=!0,e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[2,12,16,19]])})))()},btnUpper_Click:function(){try{if(1!=parseInt(this.btnUpper.Tag)?(this.btnUpper.Tag=1,this.btnUpper.Text=this.$t("上")):(this.btnUpper.Tag=2,this.btnUpper.Text=this.$t("下")),this.txtTrack.Text.Trim()&&null!=this.m_currentSetupItem){var t=this.m_currentSetupItem.Location.split("-"),e=Object(m["a"])(this.equipmentName,this.CurrentLocationIndex,t[1],this.m_division);if(this.m_currentSetupItem=g(this.m_onlineSetupList).firstOrDefault((function(t){return t.Location=e})),null==this.m_currentSetupItem)return this.showMessage(m["c"].ERR_NOTNEEDVERIFY),this.txtTrack.Text="",this.displayLocation="",void(this.VerifyData.OnlineSetupList={});this.showMessage(this.$t("上料位：{0}",[this.m_currentSetupItem.DisplayLocation])),this.txtTrack.Text=this.m_currentSetupItem.Location,this.displayLocation=this.m_currentSetupItem.DisplayLocation,this.VerifyData.OnlineSetupList=this.m_currentSetupItem}}catch(n){this.showMessage(n)}},isTopFirstC:function(){if(this.isTopFirst="ascending",console.log(this.isTopFirst),null!=this.txtTrack.Text&&""!=this.txtTrack.Text){var t=parseInt(this.txtTrack.Text.split("-")[2]);console.log(t);var e=1==t?2:1,n=this.txtTrack.Text.substring(0,this.txtTrack.Text.length-1)+e;if(console.log(n),this.m_currentSetupItem=g.from(this.m_onlineSetupList).firstOrDefault((function(t){return t.Location==n})),null!=this.m_currentSetupItem){var r=this.m_currentSetupItem.Location,s=this.m_currentSetupItem.DisplayLocation;this.showMessage(this.$t("扫描到上料位：{0}",[s])),this.txtTrack.Text=r,this.displayLocation=s,this.VerifyData.OnlineSetupList=this.m_currentSetupItem}}}}},S=x,_=(n("eff2"),n("5d22")),v=Object(_["a"])(S,r,s,!1,null,"2a10466f",null);e["default"]=v.exports},"5c5a":function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"g",(function(){return s})),n.d(e,"d",(function(){return i})),n.d(e,"f",(function(){return a})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return l}));n("4914"),n("95e8"),n("b34d"),n("a5bc"),n("b6b5"),n("0482"),n("31d6"),n("f845"),n("247c");function r(t){var e="",n=[];return n=t.split("/"),n.map((function(t,e){n[e]=t.trim()})),n.length>=6&&(-1!=n[5].indexOf("X")&&(n[5]=n[5].replace("X","")),e=n[5]),e}function s(t){var e=0,n=[];if(n=t.split("/"),n.map((function(t,e){n[e]=t.trim()})),n.length>=6){var r=n[2];-1!=r.indexOf("Q")&&(r=r.replace("Q","")),e=Number(r)}return e}function i(t){var e="",n=[];return n=t.split("*"),n.map((function(t,e){n[e]=t.trim()})),n.length>=6&&(-1!=n[1].indexOf("3OS")&&(n[1]=n[1].replace("3OS","")),e=n[1]),e}function a(t){for(var e="",n=t.split("*"),r=0;r<n.length;r++)n[r]=n[r].trim();return n.length>=6&&(e=n[0].replace(/\+/g,"").replace(/-/g,"")),e}var o=n("31d9");function u(t,e,n,r){return"X3S"==t||"X2S"==t?(o(r).endsWith("T")||(r=n%2==1?1:2,2==r&&(n-=1)),"L".concat(e,"-").concat(n,"-").concat(r)):"L".concat(e,"-").concat(n,"-").concat(r)}function c(t,e){var n=[],r=t.split("-"),s=0;return"AX501"==e?["E"+o(r[0].replace("L","")).padLeft(2,"0").s+o(r[1]).padLeft(2,"0").s]:e.startsWith("NPM")?["POS"+o(r[1]).padLeft(3,"0").s+"$"+r[2]]:(o(r[2]).endsWith("T")?n.push("POS001$"+r[2]):(s=parseInt(r[1]),"2"==r[2]&&(n.push("POS"+o(s+"").padLeft(3,"0").s+"$2"),s+=1),n.push("POS"+o(s+"").padLeft(3,"0").s+"$1")),n)}var l={ERR_LOGINFAILED:"200-登录失败",ERR_NOTNEEDVERIFY:"301-该料站不需要验料",ERR_NOTRACKINFO:"302-请扫描料站条码",ERR_NODIVISIONINFO:"303-请选择料槽号",ERR_NOCMPINFO:"304-请扫描物料",ERR_STATIONNOTINLINE:"305-机台不属于产线",ERR_SCANCOMPONENT:"306-请扫描物料",ERR_TEARDOWNFAILED:"307-卸下出错"}},"95e8":function(t,e,n){"use strict";var r=n("4292"),s=n("0a86").map,i=n("b9d5"),a=i("map");r({target:"Array",proto:!0,forced:!a},{map:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},b7bd:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-cell",{staticClass:"cellAll",scopedSlots:t._u([{key:"title",fn:function(){return[n("div",{staticClass:"custom-title"},[t._v(t._s(t.title))]),n("van-field",{staticClass:"filed",attrs:{autosize:"",type:t.type,clearable:""},on:{input:t.onInput,focus:t.fieldFocus,blur:t.fieldBlur},scopedSlots:t._u([{key:"right-icon",fn:function(){return[n("van-icon",{attrs:{name:"scan",size:"20",color:"#4284f4"}})]},proxy:!0}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})]},proxy:!0}])})},s=[],i={props:{title:{type:String,require:!1,default:"标题"},value:{require:!1,default:""},type:{type:String,require:!1,default:"textarea"}},methods:{onInput:function(t){this.value=t,this.$emit("update:value",t)},GetVal:function(){return this.value},fieldBlur:function(){window.scroll(0,this.FoucusS),window.onresize=function(){}},fieldFocus:function(){this.FoucusS=document.documentElement.scrollTop-40,window.onresize=function(){return function(){var t=document.body.clientHeight;window.scroll(0,t)}()}}}},a=i,o=(n("54ca"),n("5d22")),u=Object(o["a"])(a,r,s,!1,null,null,null);e["a"]=u.exports},bb2c:function(t,e,n){},eff2:function(t,e,n){"use strict";n("bb2c")},f648:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return i}));var r={Pending:10,Pass:20,Failed:30,Reverify_Pass:4,Reverify_Failed:5},s={Locked:1,Closed:2,Completed:3,Initialized:4,MRPLocked:5,Prepared:6,QALocked:7,Ready:8,InProcess:9},i={WatingUse:1,Using:2,Bad:3}},f845:function(t,e,n){"use strict";var r=n("4292"),s=n("016e").f,i=n("2730"),a=n("6ff7"),o=n("11a1"),u=n("8531"),c=n("0fee"),l="".startsWith,p=Math.min,f=u("startsWith"),m=!c&&!f&&!!function(){var t=s(String.prototype,"startsWith");return t&&!t.writable}();r({target:"String",proto:!0,forced:!m&&!f},{startsWith:function(t){var e=String(o(this));a(t);var n=i(p(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return l?l.call(e,r,n):e.slice(n,n+r.length)===r}})}}]);