(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17e9de29"],{"0d67":function(t,e,n){"use strict";n("7e18")},3073:function(t,e,n){},3109:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Page",{attrs:{title:t.$t("顺序检验"),msgs:"false"}},[t.div2==t.nowDiv?n("div",{ref:"con1",staticClass:"dic1"},[n("van-sticky",{attrs:{container:t.con1,"offset-top":46}},[n("div",{ref:"topdiv",staticClass:"topDiv"},[t._v(" "+t._s(t.$t("程序名"))+"："+t._s(t.program)+" "),n("br"),t._v(" "+t._s(t.$t("区域"))+":"+t._s(t.area)+" ")])]),n("van-tabs",{staticClass:"TabHeight",attrs:{color:"#4284f4"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[n("van-tab",{attrs:{title:t.$t("操作")}},[n("MessageBox",{ref:"messageBox",staticClass:"lonelyMeg"}),n("ScanInput",{directives:[{name:"show",rawName:"v-show",value:t.isShowScan,expression:"isShowScan"}],attrs:{label:t.$t("条码")},on:{submit:t.m_scanner_OnScannerReaded}}),n("InputCell",{attrs:{title:t.$t("物料条码"),value:t.ReelId},on:{"update:value":function(e){t.ReelId=e}}}),n("div",{staticClass:"checkstate"},[t._v(" "+t._s(t.$t("检验状态"))+" "),n("div",[n("div",{staticClass:"green"},[t._v(t._s(t.$t("成功"))+":"+t._s(t.PassQty))]),n("div",{staticClass:"red"},[t._v(t._s(t.$t("失败"))+":"+t._s(t.NGQty))]),n("div",{staticClass:"orange"},[t._v(t._s(t.$t("未检验"))+":"+t._s(t.WaitingQty))])])]),"AX501"==t.equipmentName?n("van-button",{staticStyle:{margin:"10px 15px",width:"calc(100% - 30px )"},attrs:{type:"info"},on:{click:t.isTopFirstC}},[t._v(t._s(t.$t("上排优先")))]):t._e(),n("van-button",{staticClass:"BtnButton",staticStyle:{width:"calc(100vw - 30px)",left:"15px"},attrs:{type:"info"},on:{click:t.btnSkipCurrent_Click}},[t._v(t._s(t.$t("跳过")))])],1),n("van-tab",{attrs:{title:t.$t("记录")}},[n("el-table",{attrs:{data:t.m_onlineSetupList,size:"mini","row-class-name":t.tableRowClassName,height:t.tableH}},[n("el-table-column",{attrs:{prop:"PARTNUMBER",label:t.$t("物料编位"),"min-width":"43%"}}),n("el-table-column",{attrs:{prop:"DisplayLocation",label:t.$t("站位"),"min-width":"27%"}}),n("el-table-column",{attrs:{prop:"VerificationResult",label:t.$t("状态"),"min-width":"30%"}})],1)],1)],1)],1):t._e()])},i=[],r=(n("247c"),n("6a61"),n("9ad1")),a=(n("5c26"),n("12f5")),o=(n("fe7f"),n("2b22")),c=(n("06bb"),n("28e4")),u=n("a593"),l=n("9973"),f=n("6168"),d=n("521f"),h=n("b7bd"),p=n("5c5a"),m=n("1c01"),g=n("f648"),_=n("cf45"),v=n("6255"),S=n("4800");u["default"].use(v["Table"]),u["default"].use(c["a"]),u["default"].use(o["a"]),u["default"].use(a["a"]);var I={components:{Page:l["a"],ScanInput:f["a"],MessageBox:d["a"],InputCell:h["a"]},data:function(){return{barcode:"",active:"",class_width_80:"width80",float:"float",clear:"clear",isGray:"gray",class_width100:"width100",m_currentIndex:-1,isTopFirst:!1,tableH:"0",m_onlineSetupList:[],m_scanner:"",m_currentSetupItem:"",lblCurrPos:[],VerifyData:{},btnVerify:{Enable:!0},ReelId:"",Color:[],CurrentLine:"",tabControl1:[],chkSortList:[],nowDiv:1,div1:0,div2:1,showMsg:"",area:"",program:"",code:"",num:"",activeTab:0,con1:null,PassQty:0,NGQty:0,WaitingQty:0,isShowScan:!1,VerifyIndex:0,equipmentName:"",currentStation:null,skipRight:!0}},mounted:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.tableH=window.screen.height-t.$refs.topdiv.offsetHeight-30-46,t.con1=t.$refs.con1,n=JSON.parse(window.localStorage.getItem("currentLine")),s=JSON.parse(window.localStorage.getItem("currentUser"));try{t.currentStation=t.$store.getters["svSession/getCurrentStation"],t.equipmentName=t.currentStation.STATION_NAME,t.area=n.LINE_NAME+", "+t.equipmentName+", L"+t.$store.getters["svSession/getCurrentLocationIndex"],i=t,t.VerifyData.VerificationMode="OnlineVerifyTableCheck",t.VerifyData.LineName=n.LINE_NAME,t.VerifyData.StationName=t.equipmentName,t.VerifyData.Operator=s.STAFF_NUMBER,t.$nextTick((function(){i.LoadSetupData()})),setTimeout((function(){window._currentMessageBox=i.$refs.messageBox}),500)}catch(r){t.showMessage("EventsCenter_OnFormReady():"+r)}case 5:case"end":return e.stop()}}),e)})))()},methods:{showMessage:function(t){this.$refs.messageBox.showMessage(t)},tableRowClassName:function(t){return t=t.row,t.VERIFICATION_RESULT==g["c"].Pass?"green":t.VERIFICATION_RESULT==g["c"].Failed?"red":void 0},nextBtn:function(){this.nowDiv=1},m_scanner_OnScannerReaded:function(t){try{if(null==this.m_onlineSetupList&&0==this.m_onlineSetupList.length)return;if(this.showMessage(this.$t("扫描到物料：{0}",[t])),this.VerifyData.PartBarcode=t,-1==t.indexOf("/"))return void this.showMessage(this.$t("条码格式不正确"));if(t=Object(p["e"])(t),null==t||t.trim().length<=0)return void this.showMessage(this.$t("条码格式不正确"));this.ReelId=t,this.VerifyData.ComponentBarcode=t}catch(e){this.showMessage('("m_scanner_OnScannerReaded():'+e)}this.Verify()},Verify:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=t.m_currentSetupItem){e.next=2;break}return e.abrupt("return");case 2:if(t.ReelId){e.next=4;break}return e.abrupt("return");case 4:return t.showMessage(t.$t("开始验证...")),t.VerifyData.OnlineSetupList=t.m_currentSetupItem,t.btnVerify.Enabled=!1,e.prev=7,t.VerifyData.ComponentBarcode=t.ReelId.trim(),t.$loading(),e.next=12,m["s"](t.VerifyData);case 12:n=e.sent,t.ReelId="",n&&(t.m_currentSetupItem.VERIFICATION_RESULT=n.VERIFICATION_RESULT,t.m_currentSetupItem.VerificationResult=n.VerificationResult,t.computeQty()),n&&n.Result?(Object(_["d"])(),s=S.from(t.m_onlineSetupList).count((function(t){return t.VERIFICATION_RESULT!=g["c"].Pass})),t.showMessage(t.$t("验证成功...")),t.showMessage(t.$t("待验料数量:{0}",[s])),t.m_currentSetupItem=null,t.GotoNext()):(Object(_["c"])(),t.showMessage(t.$t("验料失败"))),e.next=21;break;case 18:e.prev=18,e.t0=e["catch"](7),t.showMessage(t.$t("请求超时,请重新操作"));case 21:return e.prev=21,t.btnVerify.Enabled=!0,t.$clrLoading(),e.finish(21);case 25:case"end":return e.stop()}}),e,null,[[7,18,21,25]])})))()},isTopFirstC:function(){this.isTopFirst=!0,this.LoadSetupData()},btnCmpReset_Click:function(){this.ReelId=""},btnVerify_Click:function(){null!=this.ReelId&&this.ReelId.trim().length>=0&&this.Verify()},btnSkipCurrent_Click:function(){this.GotoNext()},computeQty:function(){var t=S.from(this.m_onlineSetupList).count(),e=S.from(this.m_onlineSetupList).count((function(t){return t.VERIFICATION_RESULT==g["c"].Pass||t.VERIFICATION_RESULT==g["c"].Reverify_Pass}));this.PassQty=e;var n=S.from(this.m_onlineSetupList).count((function(t){return t.VERIFICATION_RESULT==g["c"].Failed||t.VERIFICATION_RESULT==g["c"].Reverify_Failed}));this.NGQty=n,this.WaitingQty=t-this.PassQty-this.NGQty},LoadSetupData:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.$loading(),e.next=4,m["p"]({stationId:t.$store.getters["svSession/getCurrentStation"].Id,locationIndex:t.$store.getters["svSession/getCurrentLocationIndex"],isTopFirst:t.isTopFirst});case 4:if(n=e.sent,n||!(null==n.lstOnlineSetupList||n.lstOnlineSetupList.length<=0)){e.next=8;break}return t.showMessage(t.$t("无上料表")),e.abrupt("return");case 8:s=n.lstOnlineSetupList,t.program=n.recipeName,t.VerifyData.RecipeName=n.recipeName,t.m_onlineSetupList=s,t.computeQty(),S.from(t.m_onlineSetupList).all((function(t){return t.VERIFICATION_RESULT==g["c"].Pass}))&&(t.skipRight=!1),i=S.from(t.m_onlineSetupList).count((function(t){return t.VERIFICATION_RESULT!=g["c"].Pass})),t.showMessage(t.$t("待验料数量:{0}",[i])),e.next=21;break;case 18:e.prev=18,e.t0=e["catch"](0),t.showMessage("LoadSetupData():"+e.t0);case 21:return e.prev=21,t.$clrLoading(),e.finish(21);case 24:null!=t.m_onlineSetupList&&t.m_onlineSetupList.length>0&&t.GotoNext();case 25:case"end":return e.stop()}}),e,null,[[0,18,21,24]])})))()},GotoNext:function(){try{if(++this.m_currentIndex,this.m_currentIndex>=this.m_onlineSetupList.length){this.m_currentIndex=0;var t=S.from(this.m_onlineSetupList).count((function(t){return t.VERIFICATION_RESULT==g["c"].Pass})),e=S.from(this.m_onlineSetupList).count((function(t){return t.VERIFICATION_RESULT==g["c"].Failed}));this.btnVerify.Enabled=!1,this.showMessage(this.$t("成功：{0}，失败：{1}!",[t,e])),this.showMessage(this.$t("已经完成验料！")),this.m_currentSetupItem=null}else this.m_onlineSetupList[this.m_currentIndex].VERIFICATION_RESULT==g["c"].Pass&&this.skipRight?this.GotoNext():this.ShowCurrentSetupItem()}catch(n){this.showMessage("GotoNext():".concat(n))}},IsAllFinished:function(){return this.m_currentIndex==this.m_onlineSetupList.length-1},ShowCurrentSetupItem:function(){try{if(this.m_currentIndex<0||null==this.m_onlineSetupList||this.m_currentIndex>this.m_onlineSetupList.length-1)return;this.ReelId="",this.m_currentSetupItem=this.m_onlineSetupList[this.m_currentIndex],this.showMessage(this.$t("当前检验料站：")+"".concat(this.m_currentSetupItem.DisplayLocation)),this.showMessage(this.$t("需要物料:")+"".concat(this.m_currentSetupItem.PARTNUMBER))}catch(t){this.showMessage("ShowCurrentSetupItem():".concat(t))}}}},R=I,w=(n("3631"),n("0d67"),n("5d22")),b=Object(w["a"])(R,s,i,!1,null,null,null);e["default"]=b.exports},3631:function(t,e,n){"use strict";n("379d")},"379d":function(t,e,n){},"521f":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.messages,expression:"messages"}],ref:"messageBox",staticClass:"lonelyMeg",attrs:{rows:"11",readonly:""},domProps:{value:t.messages},on:{input:function(e){e.target.composing||(t.messages=e.target.value)}}})},i=[],r=(n("82a8"),{props:{showMsg:{type:String,require:!1,default:""}},data:function(){return{messages:"",count:0}},methods:{showMessage:function(t){if(null!=t&&""!=t&&void 0!=t){this.count>=50?(this.messages=" "+t+"\r\n",this.count=1):this.messages+=" "+t+"\r\n";var e=this;setTimeout((function(){e.$refs.messageBox.scrollTop=e.$refs.messageBox.scrollHeight})),this.count++}}},mounted:function(){var t="User: "+JSON.parse(localStorage.getItem("profile")).name;this.showMessage(t)},updated:function(){}}),a=r,o=n("5d22"),c=Object(o["a"])(a,s,i,!1,null,null,null);e["a"]=c.exports},"54ca":function(t,e,n){"use strict";n("3073")},"5c5a":function(t,e,n){"use strict";n.d(e,"e",(function(){return s})),n.d(e,"g",(function(){return i})),n.d(e,"d",(function(){return r})),n.d(e,"f",(function(){return a})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return l}));n("4914"),n("95e8"),n("b34d"),n("a5bc"),n("b6b5"),n("0482"),n("31d6"),n("f845"),n("247c");function s(t){var e="",n=[];return n=t.split("/"),n.map((function(t,e){n[e]=t.trim()})),n.length>=6&&(-1!=n[5].indexOf("X")&&(n[5]=n[5].replace("X","")),e=n[5]),e}function i(t){var e=0,n=[];if(n=t.split("/"),n.map((function(t,e){n[e]=t.trim()})),n.length>=6){var s=n[2];-1!=s.indexOf("Q")&&(s=s.replace("Q","")),e=Number(s)}return e}function r(t){var e="",n=[];return n=t.split("*"),n.map((function(t,e){n[e]=t.trim()})),n.length>=6&&(-1!=n[1].indexOf("3OS")&&(n[1]=n[1].replace("3OS","")),e=n[1]),e}function a(t){for(var e="",n=t.split("*"),s=0;s<n.length;s++)n[s]=n[s].trim();return n.length>=6&&(e=n[0].replace(/\+/g,"").replace(/-/g,"")),e}var o=n("31d9");function c(t,e,n,s){return"X3S"==t||"X2S"==t?(o(s).endsWith("T")||(s=n%2==1?1:2,2==s&&(n-=1)),"L".concat(e,"-").concat(n,"-").concat(s)):"L".concat(e,"-").concat(n,"-").concat(s)}function u(t,e){var n=[],s=t.split("-"),i=0;return"AX501"==e?["E"+o(s[0].replace("L","")).padLeft(2,"0").s+o(s[1]).padLeft(2,"0").s]:e.startsWith("NPM")?["POS"+o(s[1]).padLeft(3,"0").s+"$"+s[2]]:(o(s[2]).endsWith("T")?n.push("POS001$"+s[2]):(i=parseInt(s[1]),"2"==s[2]&&(n.push("POS"+o(i+"").padLeft(3,"0").s+"$2"),i+=1),n.push("POS"+o(i+"").padLeft(3,"0").s+"$1")),n)}var l={ERR_LOGINFAILED:"200-登录失败",ERR_NOTNEEDVERIFY:"301-该料站不需要验料",ERR_NOTRACKINFO:"302-请扫描料站条码",ERR_NODIVISIONINFO:"303-请选择料槽号",ERR_NOCMPINFO:"304-请扫描物料",ERR_STATIONNOTINLINE:"305-机台不属于产线",ERR_SCANCOMPONENT:"306-请扫描物料",ERR_TEARDOWNFAILED:"307-卸下出错"}},"7e18":function(t,e,n){},"95e8":function(t,e,n){"use strict";var s=n("4292"),i=n("0a86").map,r=n("b9d5"),a=r("map");s({target:"Array",proto:!0,forced:!a},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},b7bd:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-cell",{staticClass:"cellAll",scopedSlots:t._u([{key:"title",fn:function(){return[n("div",{staticClass:"custom-title"},[t._v(t._s(t.title))]),n("van-field",{staticClass:"filed",attrs:{autosize:"",type:t.type,clearable:""},on:{input:t.onInput,focus:t.fieldFocus,blur:t.fieldBlur},scopedSlots:t._u([{key:"right-icon",fn:function(){return[n("van-icon",{attrs:{name:"scan",size:"20",color:"#4284f4"}})]},proxy:!0}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})]},proxy:!0}])})},i=[],r={props:{title:{type:String,require:!1,default:"标题"},value:{require:!1,default:""},type:{type:String,require:!1,default:"textarea"}},methods:{onInput:function(t){this.value=t,this.$emit("update:value",t)},GetVal:function(){return this.value},fieldBlur:function(){window.scroll(0,this.FoucusS),window.onresize=function(){}},fieldFocus:function(){this.FoucusS=document.documentElement.scrollTop-40,window.onresize=function(){return function(){var t=document.body.clientHeight;window.scroll(0,t)}()}}}},a=r,o=(n("54ca"),n("5d22")),c=Object(o["a"])(a,s,i,!1,null,null,null);e["a"]=c.exports},f648:function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}));var s={Pending:10,Pass:20,Failed:30,Reverify_Pass:4,Reverify_Failed:5},i={Locked:1,Closed:2,Completed:3,Initialized:4,MRPLocked:5,Prepared:6,QALocked:7,Ready:8,InProcess:9},r={WatingUse:1,Using:2,Bad:3}},f845:function(t,e,n){"use strict";var s=n("4292"),i=n("016e").f,r=n("2730"),a=n("6ff7"),o=n("11a1"),c=n("8531"),u=n("0fee"),l="".startsWith,f=Math.min,d=c("startsWith"),h=!u&&!d&&!!function(){var t=i(String.prototype,"startsWith");return t&&!t.writable}();s({target:"String",proto:!0,forced:!h&&!d},{startsWith:function(t){var e=String(o(this));a(t);var n=r(f(arguments.length>1?arguments[1]:void 0,e.length)),s=String(t);return l?l.call(e,s,n):e.slice(n,n+s.length)===s}})}}]);