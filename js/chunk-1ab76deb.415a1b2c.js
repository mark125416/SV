(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ab76deb"],{"1f95":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"split"}},[n("Page",{attrs:{title:e.$t("库存盘点")},on:{clearClick:e.Reset}},[n("MessageBox",{ref:"messageBox"}),n("ScanInput",{attrs:{label:e.$t("料盘")},on:{submit:e.m_scanner_OnScannerReaded}}),n("van-field",{attrs:{label:e.$t("物编"),readonly:""},model:{value:e.partNumber,callback:function(t){e.partNumber=t},expression:"partNumber"}}),n("van-field",{attrs:{label:e.$t("库位"),readonly:""},model:{value:e.txtLocation,callback:function(t){e.txtLocation=t},expression:"txtLocation"}}),n("van-field",{class:e.class_width50,attrs:{label:e.$t("标包数量"),readonly:""},model:{value:e.txtInitQty,callback:function(t){e.txtInitQty=t},expression:"txtInitQty"}}),n("van-field",{class:e.class_width50,attrs:{label:e.$t("剩余数量"),readonly:""},model:{value:e.txtRemainQty,callback:function(t){e.txtRemainQty=t},expression:"txtRemainQty"}}),n("div",{class:e.class_lineH},[e._v(" "+e._s(e.$t("盘点数量"))+" "),n("van-stepper",{class:e.class_num,model:{value:e.numRemainQty,callback:function(t){e.numRemainQty=t},expression:"numRemainQty"}})],1),n("div",[n("van-button",{attrs:{type:"info",size:"large"},on:{click:e.Stocktake}},[e._v(e._s(e.$t("入库")))])],1)],1)],1)},s=[],r=(n("2a39"),n("247c"),n("4021"),n("6a61"),n("9ad1")),c=(n("19d0"),n("a599")),o=(n("3220"),n("8e51")),i=(n("4434"),n("82cf")),u=(n("2a00"),n("129d")),l=(n("0988"),n("59ba")),m=(n("06bb"),n("28e4")),d=n("a593"),p=n("9973"),h=n("521f"),v=n("9073"),f=n("5c5a"),y=n("6168");d["default"].use(m["a"]),d["default"].use(l["a"]),d["default"].use(u["a"]),d["default"].use(i["a"]),d["default"].use(o["a"]),d["default"].use(c["a"]);var x={components:{Page:p["a"],ScanInput:y["a"],MessageBox:h["a"]},computed:{},data:function(){return{class_width50:"width50",class_num:"inline",class_lineH:"lin",btn_M:"btn_M",m_partInventory:"",m_scanner:"",partNumber:"",m_StockTake:"",txtReelBarcode:"",txtInitQty:"",txtLocation:"",numRemainQty:"",txtRemainQty:"",checkInventoryTemp:null}},mounted:function(){var e=decodeURIComponent(this.$route.params.task);this.m_StockTake=JSON.parse(e)},methods:{showMessage:function(e){this.$refs.messageBox.showMessage(e)},m_scanner_OnScannerReaded:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=Object(f["e"])(e),a&&(e=a),n.next=4,v["a"]({EInventoryReelId:e,ML_CheckInventoryId:t.m_StockTake.Id});case 4:if(s=n.sent,s&&s.Items&&0!=s.Items.length){n.next=8;break}return t.showMessage(t.$t("条码：{0}不存在于当前盘点任务",[e])),n.abrupt("return");case 8:t.checkInventoryTemp=s.Items[0],t.showMessage(t.$t("当前条码:{0}",[e])),t.DoScanReelIdCode(e);case 11:case"end":return n.stop()}}),n)})))()},DoScanReelIdCode:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.Reset(),n.next=4,v["e"](null,{ReelId:e});case 4:if(a=n.sent,0!=a.length){n.next=9;break}return t.showMessage(e+t.$t("不存在")),t.txtReelBarcode="",n.abrupt("return");case 9:t.m_partInventory=a[0],t.txtReelBarcode=e,t.partNumber=t.m_partInventory.PartNumber,t.txtInitQty=t.m_partInventory.InitialQty,t.txtLocation=t.m_partInventory.CellName,t.txtRemainQty=t.checkInventoryTemp.ActualQuantity||t.checkInventoryTemp.SystemQuantity,t.numRemainQty=t.checkInventoryTemp.ActualQuantity||t.checkInventoryTemp.SystemQuantity,n.next=21;break;case 18:n.prev=18,n.t0=n["catch"](0),t.showMessage(t.$t("加载盘点数据出错！")+n.t0);case 21:case"end":return n.stop()}}),n,null,[[0,18]])})))()},Reset:function(){this.txtReelBarcode="",this.PartNumber="",this.txtInitQty="",this.txtLocation="",this.txtRemainQty="",this.numRemainQty=0},Stocktake:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,(e.txtReelBarcode.trim().length<=0||null==e.m_partInventory)&&e.showMessage(e.$t("请扫描料盘条码ReelID!")),n=parseInt(e.numRemainQty),e.checkInventoryTemp.ActualQuantity=n,e.checkInventoryTemp.DifferentQuantity=Math.abs(e.checkInventoryTemp.SystemQuantity-n),t.next=7,v["b"](e.checkInventoryTemp.Id,e.checkInventoryTemp);case 7:a=t.sent,a&&a.Success?(e.showMessage(e.$t("{0}盘点完成！数量：{1}",[e.txtReelBarcode,n])),e.m_partInventory=null,e.Reset()):e.showMessage(a.Message),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),e.showMessage(t.t0),e.m_partInventory=null;case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))()},btnClearReelBarcode_Click:function(){this.$refs.numRemainQty.values=0},btnTest_Click:function(){this.m_scanner_OnScannerReaded("19-AB0000-JTX*3000*VE2310026*VE2310026*20160311*1005661806206187*orcernumber")}}},g=x,b=(n("813e"),n("5d22")),I=Object(b["a"])(g,a,s,!1,null,null,null);t["default"]=I.exports},"521f":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.messages,expression:"messages"}],ref:"messageBox",staticClass:"lonelyMeg",attrs:{rows:"11",readonly:""},domProps:{value:e.messages},on:{input:function(t){t.target.composing||(e.messages=t.target.value)}}})},s=[],r=(n("82a8"),{props:{showMsg:{type:String,require:!1,default:""}},data:function(){return{messages:"",count:0}},methods:{showMessage:function(e){if(null!=e&&""!=e&&void 0!=e){this.count>=50?(this.messages=" "+e+"\r\n",this.count=1):this.messages+=" "+e+"\r\n";var t=this;setTimeout((function(){t.$refs.messageBox.scrollTop=t.$refs.messageBox.scrollHeight})),this.count++}}},mounted:function(){var e="User: "+JSON.parse(localStorage.getItem("profile")).name;this.showMessage(e)},updated:function(){}}),c=r,o=n("5d22"),i=Object(o["a"])(c,a,s,!1,null,null,null);t["a"]=i.exports},"813e":function(e,t,n){"use strict";n("9778")},9778:function(e,t,n){}}]);